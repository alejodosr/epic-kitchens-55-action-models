## Task A: Action Recognition (Alejandro Rodriguez Ramos)

- _Get familiar with the epic kitchen project: [https://epic-kitchens.github.io/2020-100](https://epic-kitchens.github.io/2020-100)_
- _Collect a couple of KFC kitchen videos from youtube as a dataset to perform the task._
  - The selected videos have been [one](https://www.youtube.com/watch?v=ZUr3DxYyTqI&t), [two](https://www.youtube.com/watch?v=c-uBjf988yE&t) and [three](https://www.youtube.com/watch?v=wiAYDb73Dbo&t). They do not provide ego-motion as in the epic kitchens dataset.
- _Go through the GitHub link: https://github.com/epic-kitchens/epic-kitchens-55-action-models and make use of two pre-trained models of your choice for running inference on your videos._
  - The selected models have been Temporal Segments Network (TSN) and Temporal Relation Network (TRN).
- _Run the models and report the approach used and model performance (most important step). In this step, we would like to see how youâ€™d compare the models in terms of accuracy, losses, and FPS._
  - The results have been reported in the remainder of the page.

_Feel free to use any sort of visualisation library to better communicate your results. Plot to impress! :)
(optional) explain how you would optimise the model to run on an edge system._
  
  ### Environment and approach
  ```
  conda version : 4.9.1
  python version : 3.8.5.final.0
  platform : linux-64
  OS: Ubuntu 18.04 Bionic Beaver
  GPU: GeForce GTX 950M (VRAM: 2GB)
  ```
  - Every video has been splitted into segments of 8 seconds each and resampled to constant 30 FPS (using this script)
  - 30 random segments have been selected. These segments have been annotated in order to provide requested metrics (_e.g._ accuracy). 
  - The models have been executed in their RGB version.
  - The selected backbone has been _Resnet 50_.
  - Models are evaluated using 10 crops (center and corner crops as well as their horizontal flips) for each clip. The scores from these are averaged pre-softmax to produce a single clip-level score (as reported in [epic kitchen evaluation paper](https://arxiv.org/pdf/1908.00867.pdf)).
  - Each segment is divided into 8 snippets of 1 frame each.
  - Batch size has been set to 1 in order to account for latency metrics.
  - Frames were loaded directly from video, using `ffmpeg` to extract snippet's frames.
  - The script used to generate results was `test_models.py` and to generate metrics was `generate_metrics.py`.
  
  ### Collected dataset
  
  | Verbs | Nouns | Actions |
| --- | --- | --- |
| ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg)  |  ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) | ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) |
  
  ### Loss
  
  The loss has been generated by applying a multi-class cross entropy function to both nouns and verbs raw network outputs. After, both resulting losses have been added.
  
| TSN | TRN |
| --- | --- |
| ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg)  |  ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) |

### Confusion matrices

| TSN | TRN |
| --- | --- |
| ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg)  |  ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) |
| ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg)  |  ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) |
| ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg)  |  ![](https://www.masquenegocio.com/wp-content/uploads/2019/03/google-images-874x492.jpg) |

### Accuracy, precision and recall

| Model | Top-1 Accuracy (Verbs) | Avg. Class Precision (Verbs) | Avg. Class Recall (Verbs) |
| --- | --- | --- | --- |
| TSN (RGB) | 13% | 8.8% | 13.3% |
| TRN (RGB) | 6% | 3.7% | 6.6% |


| Model | Top-1 Accuracy (Nouns) | Avg. Class Precision (Nouns) | Avg. Class Recall (Nouns) |
| --- | --- | --- | --- |
| TSN (RGB) | 0.0% | 0.0% | 0.0% |
| TRN (RGB) | 0.0% | 0.0% | 0.0% |


| Model | Top-1 Accuracy (Actions) | Avg. Class Precision (Actions) | Avg. Class Recall (Actions) |
| --- | --- | --- | --- |
| TSN (RGB) | 0.0% | 0.0% | 0.0% |
| TRN (RGB) | 0.0% | 0.0% | 0.0% |

### Latency and FPS

| Model | Avg. Data Loading Latency (s) | Avg. Model Inference Latency (s) | Avg. FPS |
| --- | --- | --- | --- |
| TSN (RGB) | 0.548 | 1.879 | 3.29 |
| TRN (RGB) | 1.19 | 1.88 | 2.60 |
